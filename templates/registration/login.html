{% extends "base.html" %}
{% load static %}

{% block content %}
<style>
  :root {
    --bg: #f7f7fb;
    --card: #ffffff;
    --text: #1f1f29;
    --muted: #6b6f76;
    --primary: #5b3df5;
    --primary-700: #4a2fe6;
    --ring: #e7e8ee;
    --shadow: 0 10px 30px rgba(12,18,38,.12);
  }
  * { box-sizing: border-box; }
  body { background: var(--bg); color: var(--text); font: 15px/1.4 system-ui, sans-serif; }

  .wrap { min-height: calc(100vh - 1px); display:flex; align-items:center; justify-content:center; }
  .card {
    width:100%; max-width:1000px; height: 70vh; /* a bit shorter than signup */
    background:var(--card); box-shadow:var(--shadow);
    display:grid; grid-template-columns: 1fr 0.9fr;
    overflow:hidden; border-radius:16px;
  }
  .media {
    background:
      linear-gradient(0deg, rgba(0,0,0,.18), rgba(0,0,0,.18)),
      url("https://images.unsplash.com/photo-1595526114035-0d45ed16cfbf?q=80&w=1600&auto=format&fit=crop");
    background-size:cover; background-position:center;
  }
  .panel { padding:24px 32px; display:flex; flex-direction:column; justify-content:center; gap:12px; overflow-y:auto; }
  h1 { font-size:28px; margin:0; }
  .sub { color:var(--muted); margin-bottom:6px; font-size:14px; }

  form { display:grid; grid-template-columns:1fr; gap:12px; margin-top:6px; }
  label { font-weight:600; font-size:13px; margin-bottom:4px; display:block; }

  input[type="text"], input[type="password"] {
    width:100%; height:38px; border:1px solid var(--ring); border-radius:8px;
    padding:6px 10px; font-size:14px; background:#fff; outline:none;
    transition:border-color .15s ease, box-shadow .15s ease;
  }
  input:focus { border-color:var(--primary); box-shadow:0 0 0 2px rgba(91,61,245,.2); }

  .btn {
    display:inline-flex; align-items:center; justify-content:center;
    height:42px; padding:0 14px; border-radius:999px; border:none;
    background:var(--primary); color:#fff; font-weight:600; font-size:14px;
    cursor:pointer; box-shadow:0 6px 16px rgba(91,61,245,.25);
    transition:transform .06s ease, background .15s ease;
  }
  .btn:hover { background:var(--primary-700); }
  .btn:active { transform:translateY(1px); }

  .foot { margin-top:4px; font-size:13px; color:var(--muted); }

  .err { color:#b42318; font-size:12px; margin-top:4px; }
  .non-field-errors { padding:10px 12px; border-radius:8px; background:#fff3f2; color:#8a1f16; font-size:13px; }
  .field-error { border-color:#b42318 !important; box-shadow:0 0 0 2px rgba(180,35,24,.15) !important; }

  @media (max-width: 900px) {
    .card { grid-template-columns:1fr; height:auto; }
    .media { display:none; }
    .panel { padding:20px; }
  }
</style>

<div class="wrap">
  <div class="card">
    <div class="media" aria-hidden="true"></div>

    <div class="panel">
      <h1>Log In</h1>
      <p class="sub">Welcome back! Sign in to manage your listings and bookings.</p>

      {# Show non-field errors from AuthenticationForm (e.g., "Please enter a correct username and password.") #}
      {% if form.non_field_errors %}
        <div class="non-field-errors">
          {% for err in form.non_field_errors %}• {{ err }}<br>{% endfor %}
        </div>
      {% endif %}

      <form method="post" action="">
        {% csrf_token %}

        {# Username #}
        <div>
          <label for="id_username">Username</label>
          <input
            id="id_username"
            name="{{ form.username.name|default:'username' }}"
            type="text"
            value="{{ form.username.value|default_if_none:'' }}"
            class="{% if form.username.errors %}field-error{% endif %}"
            autocomplete="username"
            required
          />
          {% if form.username.errors %}<div class="err">{{ form.username.errors|join:', ' }}</div>{% endif %}
        </div>

        {# Password #}
        <div>
          <label for="id_password">Password</label>
          <input
            id="id_password"
            name="{{ form.password.name|default:'password' }}"
            type="password"
            class="{% if form.password.errors %}field-error{% endif %}"
            autocomplete="current-password"
            required
          />
          {% if form.password.errors %}<div class="err">{{ form.password.errors|join:', ' }}</div>{% endif %}
        </div>

        {# next param support #}
        {% if next %}
          <input type="hidden" name="next" value="{{ next }}">
        {% endif %}

        <button class="btn" type="submit">Log In</button>
      </form>

      <p class="foot">
        Don’t have an account?
        <a href="/accounts/signup/">Create one</a>
        &nbsp;•&nbsp;
        <a href="{% url 'password_reset' %}">Forgot password?</a>
      </p>
    </div>
  </div>
</div>
{% endblock content %}
